@page "/news"
@using RecipeSearchWeb.Services
@inject NewsService NewsService
@rendermode InteractiveServer

<PageTitle>PowerShell & Microsoft News</PageTitle>

<link rel="stylesheet" href="css/weather.css" />

<div class="weather-container">
    <div class="weather-header">
        <h1 class="weather-title">
            <span class="weather-emoji">ðŸ“°</span>
            Tech News
        </h1>
        <p class="weather-subtitle">Latest Updates on PowerShell & Microsoft Technologies</p>
    </div>

    @if (isLoading)
    {
        <div class="loading-section">
            <div class="loading-spinner-large"></div>
            <p class="loading-text">Loading News...</p>
        </div>
    }
    else if (newsArticles != null && newsArticles.Any())
    {
        <div class="weather-grid">
            @foreach (var article in newsArticles)
            {
                <div class="weather-card">
                    <div class="weather-card-header">
                        <div class="weather-icon">@article.CategoryEmoji</div>
                        <div class="weather-date">
                            <div class="day-name">@article.Category</div>
                            <div class="date-info">@article.TimeAgo</div>
                        </div>
                    </div>

                    <div class="weather-card-body">
                        <div style="text-align: center; width: 100%;">
                            <h3 style="color: #ffffff; font-size: 1.1rem; font-weight: 300; margin-bottom: 1rem; line-height: 1.4;">
                                @article.Title
                            </h3>
                            <p style="color: #999999; font-size: 0.85rem; line-height: 1.6; margin-bottom: 1rem;">
                                @article.Summary
                            </p>
                            <div style="color: #666666; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px;">
                                @article.Source
                            </div>
                        </div>
                    </div>

                    <div class="weather-card-footer">
                        <a href="@article.Url" target="_blank" class="weather-summary" style="text-decoration: none; color: #999999; transition: color 0.2s;">
                            Read More â†’
                        </a>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="error-section">
            <p>Unable to load news articles at this time.</p>
        </div>
    }
</div>

@code {
    private List<NewsArticle>? newsArticles;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            newsArticles = await NewsService.GetLatestNewsAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading news: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }
}
