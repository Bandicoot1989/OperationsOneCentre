@using RecipeSearchWeb.Services
@using RecipeSearchWeb.Models
@inject AzureAuthService AuthService
@inject NavigationManager Navigation

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <div class="brand-container">
            <a class="navbar-brand" href="">
                <img src="logo.png" alt="Antolin" class="company-logo" />
            </a>
            <span class="app-name">Operations One</span>
        </div>
        @if (currentUser != null)
        {
            <div class="user-info">
                <span class="user-name">👤 @currentUser.FullName</span>
                <span class="user-role">@(currentUser.Role == UserRole.Admin ? "👑" : "👨‍💻") @currentUser.Role</span>
            </div>
        }
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable">
    <nav class="nav flex-column">
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> Home
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="scripts">
                <span class="bi bi-code-slash-nav-menu" aria-hidden="true"></span> Scripts
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="knowledge">
                <span class="bi bi-book-nav-menu" aria-hidden="true"></span> Knowledge Base
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="agent-context">
                <span class="bi bi-brain-nav-menu" aria-hidden="true"></span> Agent Context
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="feedback-admin">
                <span class="bi bi-chat-heart-nav-menu" aria-hidden="true"></span> Feedback & Training
            </NavLink>
        </div>

        @if (currentUser != null)
        {
            <div class="nav-item px-3 logout-container">
                <a href="@AuthService.GetLogoutUrl()" class="nav-link">
                    <span class="bi bi-box-arrow-right-nav-menu" aria-hidden="true"></span> Logout
                </a>
            </div>
        }
    </nav>
</div>

@code {
    private User? currentUser = null;

    protected override void OnInitialized()
    {
        currentUser = AuthService.GetCurrentUser();
    }
}

<style>
.brand-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

.company-logo {
    height: 40px;
    width: auto;
    object-fit: contain;
    filter: brightness(1.1);
    transition: all 0.3s ease;
}

.company-logo:hover {
    filter: brightness(1.3) drop-shadow(0 0 8px rgba(0, 212, 255, 0.4));
    transform: scale(1.05);
}

.app-name {
    font-size: 0.7rem;
    color: #00d4ff;
    text-transform: uppercase;
    letter-spacing: 3px;
    font-weight: 300;
    opacity: 0.9;
}

.user-info {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    font-size: 0.75rem;
    color: #fff;
}

.user-name {
    font-weight: 500;
    margin-bottom: 0.2rem;
}

.user-role {
    font-size: 0.7rem;
    opacity: 0.7;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.logout-container a {
    cursor: pointer;
}

.logout-container a:hover {
    background: rgba(255,255,255,0.1);
}

@@media (max-width: 640.98px) {
    .user-info {
        font-size: 0.65rem;
    }
    
    .company-logo {
        height: 30px;
    }
    
    .app-name {
        font-size: 0.6rem;
        letter-spacing: 2px;
    }
}
</style>